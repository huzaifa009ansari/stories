chapter 5 is the complete version of this.